{"author":"Gk0Wk","dependents":"","description":"draw.io powerful diagram editor for TiddlyWiki","list":"readme config LICENSE","name":"draw.io","plugin-type":"plugin","text":"{\"tiddlers\":{\"$:/config/EditorTypeMappings/text/x-drawio\":{\"title\":\"$:/config/EditorTypeMappings/text/x-drawio\",\"text\":\"drawio\"},\"$:/config/EditorTypeMappings/application/vnd.drawio\":{\"title\":\"$:/config/EditorTypeMappings/application/vnd.drawio\",\"text\":\"drawio\"},\"$:/config/EditorTypeMappings/application/x-drawio\":{\"title\":\"$:/config/EditorTypeMappings/application/x-drawio\",\"text\":\"drawio\"},\"$:/plugins/Gk0Wk/drawio/LICENSE\":{\"title\":\"$:/plugins/Gk0Wk/drawio/LICENSE\",\"type\":\"text/plain\",\"text\":\"\\nMIT License\\n\\nCopyright (c) 2023 Gk0Wk(nmg_wk@yeah.net)\\n\\nPermission is hereby granted, free of charge, to any person obtaining a copy\\nof this software and associated documentation files (the \\\"Software\\\"), to deal\\nin the Software without restriction, including without limitation the rights\\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\\ncopies of the Software, and to permit persons to whom the Software is\\nfurnished to do so, subject to the following conditions:\\n\\nThe above copyright notice and this permission notice shall be included in all\\ncopies or substantial portions of the Software.\\n\\nTHE SOFTWARE IS PROVIDED \\\"AS IS\\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\\nSOFTWARE.\\n\"},\"$:/plugins/Gk0Wk/drawio/config/theme-light\":{\"title\":\"$:/plugins/Gk0Wk/drawio/config/theme-light\",\"text\":\"Kennedy\"},\"$:/plugins/Gk0Wk/drawio/config/theme-dark\":{\"title\":\"$:/plugins/Gk0Wk/drawio/config/theme-dark\",\"text\":\"dark\"},\"$:/plugins/Gk0Wk/drawio/config\":{\"title\":\"$:/plugins/Gk0Wk/drawio/config\",\"tags\":\"$:/tags/ControlPanel/SettingsTab\",\"type\":\"text/vnd.tiddlywiki\",\"caption\":\"draw.io\",\"list-after\":\"$:/core/ui/ControlPanel/Settings/TiddlyWiki\",\"text\":\"\\\\define theme-selector(tiddler)\\n$tiddler$\\n<$select tiddler=\\\"$tiddler$\\\" default=\\\"Kennedy\\\">\\n<$list filter=\\\"[[Kennedy dark min simple atlas sketch]split[ ]unique[]]\\\">\\n<option value=<<currentTiddler>>><$text text=<<currentTiddler>>/></option>\\n</$list>\\n</$select>\\n\\\\end\\n\\n<$list filter=\\\"[[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]]\\\" variable=\\\"lang\\\">\\n<$list filter=\\\"[<lang>search[zh]]\\\">\\n\\n!! 主题\\n\\n; 日间模式所使用的主题\\n: <<theme-selector tiddler:\\\"$:/plugins/Gk0Wk/drawio/config/theme-light\\\" >>\\n\\n; 夜间模式所使用的主题\\n: <<theme-selector tiddler:\\\"$:/plugins/Gk0Wk/drawio/config/theme-dark\\\" >>\\n\\n> 不同的主题的样式可以参考[[官网文档|https://www.drawio.com/blog/diagram-editor-theme]]。\\n\\n</$list>\\n\\n<$list filter=\\\"[<lang>!search[zh]]\\\">\\n\\n!! Themes\\n\\n; Theme used for light mode\\n: <<theme-selector tiddler:\\\"$:/plugins/Gk0Wk/drawio/config/theme-light\\\" >>\\n\\n; Theme used for dark mode\\n: <<theme-selector tiddler:\\\"$:/plugins/Gk0Wk/drawio/config/theme-dark\\\" >>\\n\\n> Different themes can be found in the [[official documentation|https://www.drawio.com/blog/diagram-editor-theme]].\\n\\n</$list>\\n</$list>\\n\"},\"$:/plugins/Gk0Wk/drawio/icon\":{\"title\":\"$:/plugins/Gk0Wk/drawio/icon\",\"tags\":\"$:/tags/Image\",\"text\":\"<svg width=\\\"22pt\\\" height=\\\"22pt\\\" class=\\\"tc-image-button\\\" viewBox=\\\"0 0 128 128\\\">\\n  <g id=\\\"draw\\\" clip-path=\\\"url(#clip_1)\\\">\\n    <path d=\\\"M128 0L128 0L128 128L0 128L0 0L128 0Z\\\" id=\\\"draw\\\" fill=\\\"none\\\" stroke=\\\"none\\\" />\\n    <path d=\\\"M101.848 114.126L101.848 125.337C101.848 126.984 103.241 128.319 104.958 128.319L110.244 128.319C111.962 128.319 113.354 126.984 113.354 125.337L113.354 114.126L125.046 114.126C126.764 114.126 128.156 112.791 128.156 111.144L128.156 106.373C128.156 104.726 126.764 103.391 125.046 103.391L113.354 103.391L113.354 91.9411C113.354 90.2943 111.962 88.9594 110.244 88.9594L104.958 88.9594C103.241 88.9594 101.848 90.2943 101.848 91.9411L101.848 103.391L89.8451 103.391C88.1277 103.391 86.7354 104.726 86.7354 106.373L86.7354 111.144C86.7354 112.791 88.1277 114.126 89.8451 114.126L101.848 114.126ZM60.474 1.59869L60.474 1.59869C60.474 1.59869 60.474 1.59869 60.474 1.59869C55.7146 -1.03617 49.6287 0.527467 46.8808 5.09117L1.49079 80.476C-1.25707 85.0397 0.37363 90.8753 5.13306 93.5102L58.0708 122.817C62.8302 125.452 68.9161 123.888 71.6639 119.324L117.054 43.9396C117.054 43.9396 117.054 43.9396 117.054 43.9396C119.802 39.3759 118.171 33.5403 113.412 30.9054L60.474 1.59869L60.474 1.59869ZM56.5918 51.9022L56.5918 51.9022C55.3231 50.5536 55.1422 48.3175 56.287 46.4161L62.0179 36.8981C63.394 34.6126 66.1645 33.6761 68.206 34.8062L79.5725 41.0988C81.614 42.229 82.1534 44.9979 80.7772 47.2834L75.0464 56.8014C73.9006 58.7043 71.7881 59.6721 69.9347 59.2904L68.8553 76.1343L75.2842 79.6934C77.3257 80.8236 77.8651 83.5926 76.489 85.878L70.7581 95.396C69.382 97.6815 66.6115 98.6181 64.57 97.4879L53.2035 91.1953C51.162 90.0651 50.6227 87.2962 51.9988 85.0107L57.7296 75.4927C59.1058 73.2072 61.8763 72.2707 63.9177 73.4009L64.925 73.9585C65.1558 69.9973 65.6868 60.8327 65.8722 57.2402L60.4735 54.2514C57.3215 56.2016 49.3099 61.2249 45.8476 63.3971L46.8405 63.9468C48.882 65.0769 49.4214 67.8459 48.0453 70.1314L42.3144 79.6493C40.9383 81.9348 38.1678 82.8714 36.1263 81.7412L24.7598 75.4486C22.7183 74.3185 22.1789 71.5495 23.555 69.264L29.2859 59.7461C30.662 57.4606 33.4325 56.524 35.474 57.6542L41.9174 61.2213L56.5918 51.9022L56.5918 51.9022L56.5918 51.9022Z\\\" id=\\\"Shape\\\" fill-rule=\\\"evenodd\\\" stroke=\\\"none\\\" />\\n  </g>\\n</svg>\"},\"$:/plugins/Gk0Wk/drawio/new-drawio-diagram\":{\"title\":\"$:/plugins/Gk0Wk/drawio/new-drawio-diagram\",\"tags\":\"$:/tags/PageControls $:/tags/ViewToolbar\",\"hint\":\"<$text text={{{ [[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]search[zh]then[新建一个draw.io图表条目]else[Create a new draw.io diagram tiddler]] }}} />\",\"description\":\"<$text text={{{ [[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]search[zh]then[新建一个draw.io图表条目]else[Create a new draw.io diagram tiddler]] }}} />\",\"caption\":\"{{$:/plugins/Gk0Wk/drawio/icon}} <$text text={{{ [[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]search[zh]then[新建图表]else[new diagram]] }}} />\",\"text\":\"\\\\whitespace trim\\n\\n\\\\define createDiagram()\\n<$action-createtiddler $basetitle={{{ [[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]search[zh]then[图表]else[Diagram]] }}} type=\\\"application/vnd.drawio\\\" >\\n<$action-sendmessage $message=\\\"tm-edit-tiddler\\\" $param=<<createTiddler-title>>/>\\n</$action-createtiddler>\\n\\\\end\\n\\n\\\\define drawioButton()\\n\\\\whitespace trim\\n<$button tooltip={{{ [[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]search[zh]then[新建一个draw.io图表条目]else[Create a new draw.io diagram tiddler]] }}} aria-label={{{ [[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]search[zh]then[新建图表]else[new diagram]] }}} class=<<tv-config-toolbar-class>> actions=<<createDiagram>> >\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n{{$:/plugins/Gk0Wk/drawio/icon}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\">\\n<$text text={{{ [[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]search[zh]then[新建图表]else[new diagram]] }}} />\\n</span>\\n</$list>\\n</$button>\\n\\\\end\\n\\n<<drawioButton>>\\n\"},\"$:/plugins/Gk0Wk/drawio/readme\":{\"title\":\"$:/plugins/Gk0Wk/drawio/readme\",\"type\":\"text/vnd.tiddlywiki\",\"caption\":\"draw.io\",\"text\":\"<img src=\\\"https://www.drawio.com/assets/img/blog/feature-flag-gitflow-tags.png\\\" width=\\\"100%\\\" height=\\\"auto\\\" >\\n\\n<$list filter=\\\"[[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]]\\\" variable=\\\"lang\\\">\\n<$list filter=\\\"[<lang>search[zh]]\\\">\\n\\ndraw.io 是一个强大的在线图表编辑器，可以用来绘制流程图、组织结构图、UML图、网络图、平面图、电路图、数据库图、房屋平面图、地图等等。\\n\\n现在我将其集成到了 <$text text=\\\"TiddlyWiki\\\" /> 中，你可以在这里使用它。点击 {{$:/plugins/Gk0Wk/drawio/icon}} 按钮，就可以创建一个新的图表条目，该条目在非编辑模式下会显示其绘制的内容，而在编辑模式下则会进入 draw.io 的编辑界面。\\n\\n注意：编辑模式需要联网才能使用，因为 draw.io 是在线编辑器，初次加载需要一定的时间，所以请耐心等待。但是预览图片不需要联网，所以你可以在离线状态下查看图表，此时它和你其他的图片没有区别。\\n\\n你可以在插件的设置中修改编辑器在日间或夜间模式下的主题。\\n\\n在编辑器中，你可以导入和导出各种类型的图表文件。图标实际上将以 SVG+嵌入式 XML 的形式保存在 <$text text=\\\"TiddlyWiki\\\" /> 中，这样可以保证图表的可编辑性。你可以在编辑器中导出为各种格式的文件，也可以在 <$text text=\\\"TiddlyWiki\\\" /> 中导出为 SVG、PNG 等文件。\\n\\n> 如果你觉得编辑器太小，在编辑器的右下角有一个 {{$:/core/images/full-screen-button}} 全屏按钮，点击即可全屏编辑器，再次按 <kbd>Esc</kbd> 即可退出全屏!\\n\\n你可以在这里查看 draw.io 的官方文档：https://www.drawio.com/\\n\\n快来试试吧！\\n\\n</$list>\\n\\n<$list filter=\\\"[<lang>!search[zh]]\\\">\\n\\ndraw.io is a powerful online diagram editor that can be used to draw flowcharts, organizational charts, UML diagrams, network diagrams, floor plans, circuit diagrams, database diagrams, house floor plans, maps, etc.\\n\\nNow I have integrated it into <$text text=\\\"TiddlyWiki\\\" />, you can use it here. Click the {{$:/plugins/Gk0Wk/drawio/icon}} button to create a new diagram tiddler, which will display its drawing content in non-editing mode, and will enter the draw.io editing interface in editing mode.\\n\\nNote: The editing mode requires networking, because draw.io is an online editor, which takes some time to load for the first time, so please be patient. But the preview image does not require networking, so you can view the chart in offline mode, and it is no different from your other images.\\n\\nYou can modify the theme of the editor in the settings of the plugin in day or night mode.\\n\\nIn the editor, you can import and export various types of chart files. The icon is actually saved in the form of SVG+embedded XML in <$text text=\\\"TiddlyWiki\\\" />, which ensures the editability of the chart. You can export to various formats of files in the editor, or export to SVG, PNG and other files in <$text text=\\\"TiddlyWiki\\\" />.\\n\\n> If you think the editor is too small, there is a {{$:/core/images/full-screen-button}} full screen button in the lower right corner of the editor, click to enter full screen editor, press <kbd>Esc</kbd> again to exit full screen!\\n\\nYou can view the official documentation of draw.io here: https://www.drawio.com/\\n\\nCome and try it!\\n\\n</$list>\\n</$list>\\n\"},\"$:/plugins/Gk0Wk/drawio/edit-drawio.js\":{\"title\":\"$:/plugins/Gk0Wk/drawio/edit-drawio.js\",\"module-type\":\"widget\",\"type\":\"application/javascript\",\"Modern.TiddlyDev#Origin\":\"edit-drawio.ts\",\"text\":\"\\\"use strict\\\";var drawioUnmountCheckTimer,editTextWidgetFactory=require(\\\"$:/core/modules/editor/factory.js\\\")[\\\"editTextWidgetFactory\\\"],SimpleEngine=require(\\\"$:/core/modules/editor/engines/simple.js\\\")[\\\"SimpleEngine\\\"],checkIfDarkMode=($tw.utils.registerFileType(\\\"application/x-drawio\\\",\\\"utf8\\\",\\\".drawio\\\",{flags:[\\\"image\\\"],deserializerType:\\\"image/svg+xml\\\"}),$tw.utils.registerFileType(\\\"application/vnd.drawio\\\",\\\"utf8\\\",\\\".drawio\\\",{flags:[\\\"image\\\"],deserializerType:\\\"image/svg+xml\\\"}),()=>{var e;return\\\"dark\\\"===(null==(e=null==(e=$tw.wiki.getTiddler($tw.wiki.getTiddlerText(\\\"$:/palette\\\")))?void 0:e.fields)?void 0:e[\\\"color-scheme\\\"])}),isChinese=()=>$tw.wiki.getTiddler(\\\"$:/language\\\").fields.text.includes(\\\"zh\\\"),drawioEditorInstance=new Set,registerInstance=e=>{$tw.browser&&void 0===drawioUnmountCheckTimer&&(drawioEditorInstance.add(e),drawioUnmountCheckTimer=setInterval(()=>{var e=[];for(const t of drawioEditorInstance)void 0!==t.iframeNode&&document.contains(t.iframeNode)||e.push(t);for(const i of e)drawioEditorInstance[\\\"delete\\\"](i);drawioEditorInstance.size<1&&(drawioUnmountCheckTimer=void 0,clearInterval(drawioUnmountCheckTimer))},1e3))},DrawIOEditor=class{constructor({widget:d,value:e,parentNode:t,nextSibling:i}){if(this.parentNode=t,this.nextSibling=i,$tw.browser){this.iframeNode=$tw.utils.domMaker(\\\"iframe\\\",{document:d.document,\\\"class\\\":\\\"gk0wk-drawio-iframe\\\",attributes:{frameborder:\\\"0\\\"},style:{margin:\\\"0\\\",border:\\\"none\\\",width:\\\"100%\\\",minHeight:\\\"700px\\\",maxHeight:\\\"90vh\\\",height:\\\"100%\\\"}}),t.insertBefore(this.iframeNode,i),d.domNodes.push(this.iframeNode);var r=$tw.utils.domMaker(\\\"button\\\",{\\\"class\\\":\\\"full-screen-button\\\",innerHTML:$tw.wiki.renderTiddler(\\\"text/html\\\",\\\"$:/core/images/full-screen-button\\\"),attributes:{title:isChinese()?\\\"全屏模式\\\":\\\"Full screen mode\\\"},style:{position:\\\"absolute\\\",right:\\\"0\\\",bottom:\\\"-42px\\\",padding:\\\"0 15px\\\",background:\\\"#fff3\\\",border:\\\"1px #fff7 solid\\\",cursor:\\\"pointer\\\"}});r.onclick=()=>this.setFullscreen(!0),t.insertBefore(r,i),d.domNodes.push(r),this.xml=e;let a=!1;const o=({data:e,source:t})=>{var i;if(null!==(null==(i=this.iframeNode)?void 0:i.contentWindow)&&t===this.iframeNode.contentWindow){const{event:n,...s}=$tw.utils.parseJSONSafe(e,()=>({}));switch(n){case\\\"init\\\":if(a)return;a=!0,this.iframeNode.contentWindow.postMessage(JSON.stringify({action:\\\"load\\\",xml:this.xml,autosave:1}),\\\"*\\\");break;case\\\"configure\\\":this.iframeNode.contentWindow.postMessage(JSON.stringify({action:\\\"configure\\\",config:{compressXml:!0,enableCssDarkMode:!1}}),\\\"*\\\");break;case\\\"load\\\":case\\\"save\\\":case\\\"autosave\\\":this.iframeNode.contentWindow.postMessage(JSON.stringify({action:\\\"export\\\",format:\\\"xmlsvg\\\",embedImages:!0,keepTheme:!0,twEditor:!0}),\\\"*\\\");break;case\\\"openLink\\\":var{href:r,target:o}=s;window.open(r,o);break;case\\\"export\\\":var{message:r,data:o}=s;if(o&&r.twEditor){r=$tw.utils.base64Decode(o.split(\\\",\\\",2)[1]);if(r===this.xml)return;this.xml=r,d.saveChanges(r)}}}};var r=$tw.wiki.getTiddlerText(checkIfDarkMode()?\\\"$:/plugins/Gk0Wk/drawio/config/theme-dark\\\":\\\"$:/plugins/Gk0Wk/drawio/config/theme-light\\\",\\\"\\\")||\\\"Kennedy\\\";window.addEventListener(\\\"message\\\",o),this.iframeNode.setAttribute(\\\"src\\\",`https://embed.diagrams.net/?embed=1&ui=${r}&spin=1&libraries=1&noExitBtn=1&saveAndExit=0&noSaveBtn=1&proto=json&protocol=json&configure=1`),this.unmount=()=>{window.removeEventListener(\\\"message\\\",o)},registerInstance(this)}else r=$tw.utils.domMaker(\\\"div\\\",{document:d.document,\\\"class\\\":\\\"gk0wk-drawio-preview\\\",style:{margin:\\\"0\\\",border:\\\"none\\\",width:\\\"100%\\\",height:\\\"100%\\\"},innerHTML:e}),t.insertBefore(r,i),d.domNodes.push(r),this.xml=\\\"\\\",this.unmount=()=>null}loadXml(e){var t,i;e!==this.xml&&null!=(i=null==(t=null==(t=this.iframeNode)?void 0:t.contentWindow)?void 0:t.postMessage)&&i.call(t,JSON.stringify({action:\\\"load\\\",xml:e,autosave:1}),\\\"*\\\")}resize(){}fixHeight(){this.resize()}focus(){var e,t;null!=(t=null==(e=this.iframeNode)?void 0:e.focus)&&t.call(e)}createTextOperation(){return{text:\\\"\\\",selection:\\\"\\\",selStart:0,selEnd:0,cutStart:null,cutEnd:null,replacement:null,newSelStart:null,newSelEnd:null}}executeTextOperation(){return this.xml}updateDomNodeText(e){this.loadXml(e)}setText(e,t){this.loadXml(e)}setFullscreen(e=!0){var t,i;e?null!=(i=null==(t=this.iframeNode)?void 0:t.requestFullscreen)&&i.call(t):document.exitFullscreen()}},engine=$tw.browser?DrawIOEditor:SimpleEngine;exports[\\\"edit-drawio\\\"]=editTextWidgetFactory(engine,engine);\"}}}","title":"$:/plugins/Gk0Wk/drawio","type":"application/json","version":"0.0.7","Modern.TiddlyDev#SHA256-Hashed":"1a02cd38859869b05e90e2eec3265614ee0f1a4787dcde3885b95f84ef303fc8"}